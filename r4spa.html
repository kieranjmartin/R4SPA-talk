<!DOCTYPE html>
<html>
  <head>
    <title>R4SPA: R Packages and Training to enable Statistical Programming in R</title>
    <meta charset="utf-8">
    <meta name="author" content="Kieran Martin" />
    <link rel="stylesheet" href="libs/remark-css/default.css" type="text/css" />
    <link rel="stylesheet" href="libs/remark-css/metropolis.css" type="text/css" />
    <link rel="stylesheet" href="libs/remark-css/metropolis-fonts.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

# R4SPA: R Packages and Training to enable Statistical Programming in R
### Kieran Martin
### 2018/08/16

---


layout: true

background-image: url("https://github.com/kieranjmartin/R4SPA-talk/raw/master/r4spa_files/images/rochelogo.png")

background-position: right top

background-size: auto
z-index: 1


---



# Outline

- Who are we?
- What was the problem?
- How did we solve it?
  - diffdf
  - Tailored R training
  - Some other efforts in the background

---

# Who are we?

- This work today is a collaboration between two people:
  - Kieran Martin and Craig Gower
  - check out https://github.com/gowerc and https://github.com/kieranjmartin
  - My twitter is @kjmartinstats
- We are Data Analytic Specialists
- New function, part of statistical programming
- Want to modernise statistical programming and new ways of addressing new challenges

---

# What was the problem?

Statistical Programmers want to use R!

- Lots of attendance on R training courses
- Lots of engagement in discussion around R

But very little... actual R outputs!

---

# What was the problem?

Lack of use cases for R

Key piece of Programming work is setting up analysis datasets

Reluctance to use R for this task?

Why?

---

# Why?

Belief that data manipulation in R is difficult

Lack of tools (proc compare)

Unclear how to work in production

---

# What we are doing

diffdf

R training

helper packages

---

#diffdf

Package for comparing datasets

Main page: https://gowerc.github.io/diffdf/

Now on CRAN: https://CRAN.R-project.org/package=diffdf

Check out github: https://github.com/gowerc/diffdf

---
# diffdf example of use:




```r
library(diffdf)
test_data
```

```
## # A tibble: 30 x 11
##       ID GROUP1 GROUP2 INTEGER BINARY DATE       DATETIME           
##    &lt;int&gt;  &lt;dbl&gt;  &lt;int&gt;   &lt;int&gt; &lt;chr&gt;  &lt;date&gt;     &lt;dttm&gt;             
##  1     1      1      1      41 M      2003-06-22 2000-11-28 20:40:53
##  2     2      1      2      41 F      2016-12-03 1994-08-30 19:05:02
##  3     3      1      3      41 M      2016-05-08 1992-09-11 11:30:18
##  4     4      1      4      32 M      2015-06-02 2007-11-12 11:28:29
##  5     5      1      5      55 F      1986-04-15 1998-08-04 01:27:49
##  6     6      1      6      33 M      1994-05-25 2001-12-05 08:24:35
##  7     7      1      7      40 F      2009-02-08 1986-11-02 18:13:03
##  8     8      1      8      44 F      2020-07-21 1998-08-22 05:23:24
##  9     9      1      9      51 F      1967-05-25 2003-01-03 22:09:29
## 10    10      1     10      40 M      2044-03-11 1996-04-19 11:10:12
## # ... with 20 more rows, and 4 more variables: CONTINUOUS &lt;dbl&gt;,
## #   CATEGORICAL &lt;fct&gt;, LOGICAL &lt;lgl&gt;, CHARACTER &lt;chr&gt;
```


---
# diffdf: missing columns:

```r
diffdf( test_data , test_data)
```

```
## No issues were found!
```

```r
test_data2 &lt;- test_data 
test_data2 &lt;- test_data2[,-6]
diffdf(test_data , test_data2 , suppress_warnings = T)
```

```
## Differences found between the objects!
## 
## A summary is given below.
## 
## There are columns in BASE that are not in COMPARE !!
## All rows are shown in table below
## 
##   =========
##    COLUMNS 
##   ---------
##     DATE   
##   ---------
```
---
# diffdf: missing rows

```r
test_data2 &lt;- test_data
test_data2 &lt;- test_data2[1:(nrow(test_data2) - 2),]
diffdf(test_data, test_data2 , suppress_warnings = T)
```

```
## Differences found between the objects!
## 
## A summary is given below.
## 
## There are rows in BASE that are not in COMPARE !!
## All rows are shown in table below
## 
##   ===============
##    ..ROWNUMBER.. 
##   ---------------
##         29       
##         30       
##   ---------------
```
---
# diffdf: different values

```r
test_data2 &lt;- test_data
test_data2[5,2] &lt;- 6
difval &lt;- diffdf(test_data , test_data2 , suppress_warnings = T)
difval$NumDiff
```

```
## # A tibble: 1 x 2
##   Variable `No of Differences`
## * &lt;chr&gt;                  &lt;int&gt;
## 1 GROUP1                     1
```

```r
difval$VarDiff_GROUP1
```

```
## # A tibble: 1 x 4
##   VARIABLE ..ROWNUMBER..  BASE COMPARE
## * &lt;chr&gt;            &lt;int&gt; &lt;dbl&gt;   &lt;dbl&gt;
## 1 GROUP1               5     1       6
```
---
# diffdf: different attributes

```r
test_data2 &lt;- test_data
attr(test_data$ID , "label") &lt;- "This is a interesting label"
attr(test_data2$ID , "label") &lt;- "what do I type here?"
diffdf(test_data , test_data2 , suppress_warnings = T)
```

```
## Differences found between the objects!
## 
## A summary is given below.
## 
## There are columns in BASE and COMPARE with differing attributes !!
## All rows are shown in table below
## 
##   ========================================================================
##    VARIABLE  ATTR_NAME          VALUES.BASE              VALUES.COMP      
##   ------------------------------------------------------------------------
##       ID       label    This is a interesting label  what do I type here? 
##   ------------------------------------------------------------------------
```
---

# diffdf: specify id variables

```r
test_data2 &lt;- test_data
test_data2$INTEGER[c(5,2,15)] &lt;- 99L 
iddiff &lt;- diffdf( test_data , test_data2 , keys = c("GROUP1" , "GROUP2") ,
        suppress_warnings = T)
iddiff$NumDiff
```

```
## # A tibble: 1 x 2
##   Variable `No of Differences`
## * &lt;chr&gt;                  &lt;int&gt;
## 1 INTEGER                    3
```

```r
iddiff$VarDiff_INTEGER
```

```
## # A tibble: 3 x 5
##   VARIABLE GROUP1 GROUP2  BASE COMPARE
## * &lt;chr&gt;     &lt;dbl&gt;  &lt;int&gt; &lt;int&gt;   &lt;int&gt;
## 1 INTEGER       1      2    41      99
## 2 INTEGER       1      5    55      99
## 3 INTEGER       1     15    44      99
```

---
# R training 

In house training on **data manipulation** using the **tidyverse**

**What makes this different?**

- Focused on **one** task: data derivation
- tidyverse makes **easier** to read code (those with less R experience)
- Exercises based on our data and specifications
- Plan to train people with a specific **use case** for the training

---
# Other activities / Q and A

Other helper packages


**Goal**: make people's lives easier when working in R


Any questions?

---

&lt;div id="over"&gt;
&lt;span class="Centerer"&gt;    &lt;/span&gt;
    &lt;img class="Centered" src="https://github.com/kieranjmartin/R4SPA-talk/raw/master/r4spa_files/images/rocheslogan.png" &gt;

&lt;/div&gt;
    </textarea>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"highlightStyle": "github",
"highlightLines": true,
"countIncrementalSlides": false
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function() {
  var d = document, s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})();</script>

<script>
(function() {
  var i, text, code, codes = document.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
})();
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
